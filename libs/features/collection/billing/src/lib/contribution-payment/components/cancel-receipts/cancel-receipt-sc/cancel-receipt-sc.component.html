<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->
<div class="content height-adjust">
  <div class="row no-gutters mb-4">
    <div class="col-auto px-2 border-right align-self-center">
      <a (click)="navigateBack(isEditMode ? false : undefined)">
        <fa-icon
          class="back-icon"
          [icon]="['far', lang === 'ar' ? 'arrow-alt-circle-right' : 'arrow-alt-circle-left']"
          size="2x"
        ></fa-icon>
      </a>
    </div>
    <div class="col-auto heading">{{ 'BILLING.CANCEL-RECEIPT' | translate }}</div>
  </div>

  <gosi-alert-sc></gosi-alert-sc>

  <div class="row">
    <div class="col-lg-12">
      <table class="table table-borderless custom-table cancel-table-res">
        <thead>
          <tr>
            <th>{{ 'BILLING.RECEIPT-NUMBER' | translate | titlecase }}</th>
            <th>{{ 'BILLING.RECEIPT-DATE' | translate | titlecase }}</th>
            <th>{{ 'BILLING.RECEIPT-MODE' | translate | titlecase }}</th>
            <th>{{ 'BILLING.AMOUNT' | translate | titlecase }}</th>
            <th>{{ 'BILLING.PAYMENT-REFERENCE-NUMBER' | translate | titlecase }}</th>
            <th>{{ 'BILLING.APPROVAL-STATUS' | translate | titlecase }}</th>
          </tr>
        </thead>

        <tbody *ngIf="receipt">
          <tr class="border-bottom">
            <td class="pointer" (click)="showModal(receiptOverview, 'lg')">{{ receipt.parentReceiptNo }}</td>
            <td>{{ receipt.receiptGenerationDate.gregorian | date: 'dd/MM/yyyy' }}</td>
            <td>{{ receipt.receiptMode | bilingualText }}</td>
            <td>{{ amount | number: '1.2-2' }}</td>
            <td>{{ receipt.referenceNo }}</td>
            <td>{{ receipt.approvalStatus | bilingualText }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="content">
  <div class="sub-section">
    <div class="row">
      <div class="col-lg-6">
        <gosi-input-select-dc
          id="cancellationReason"
          label="BILLING.CANCELLATION-REASON"
          [control]="receiptDetailsForm.get('reasonForCancellation')"
          [list]="cancellationReasonList$ | async"
          [placeholder]="'BILLING.CANCELLATION-REASON' | translate"
          (select)="otherValueSelect()"
        >
        </gosi-input-select-dc>
      </div>
      <div class="col-lg-6" *ngIf="otherReasonFlag">
        <gosi-input-text-dc
          id="bankName"
          [label]="'BILLING.OTHER-REASON' | translate"
          [control]="receiptDetailsForm.get('cancellationReasonOthers')"
          [placeholder]="'BILLING.OTHER-REASON' | translate"
        >
        </gosi-input-text-dc>
      </div>
      <!-- <div class="pl-4" [ngClass]="otherReasonFlag ? 'col-lg-12' : 'col-lg-6'">
        <gosi-input-radio-dc
          id="indicator"
          [label]="'BILLING.CALCULATE-LATE-FEES'"
          [control]="receiptDetailsForm.get('penaltyIndicator')"
          [list]="indicatorList"
          (select)="getPenaltyIndicator($event)"
        >
        </gosi-input-radio-dc>
      </div> -->
    </div>
    <div class="row">
      <div class="col-lg-12 sub-header">
        {{ 'BILLING.DOCUMENTS' | translate | titlecase }}
      </div>
      <div class="col-lg-12 mx-2">
        <ng-container *ngFor="let item of documents; let i = index">
          <gosi-input-file-sc
            [isScan]="true"
            [index]="i"
            [businessKey]="receiptNumber"
            [transactionId]="documentTransactionId"
            [document]="item"
            (refresh)="refreshDocument(item)"
            [uuid]="uuid"
          ></gosi-input-file-sc>
        </ng-container>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">
        <gosi-input-text-area-dc
          id="comments"
          label="BILLING.COMMENTS"
          [maxLength]="100"
          [control]="receiptDetailsForm.get('comments')"
        >
        </gosi-input-text-area-dc>
      </div>
    </div>
  </div>
  <!-- Action area -->
  <div class="row">
    <div class="col-lg-12">
      <blg-action-area-dc
        primaryButtonLabel="BILLING.SUBMIT"
        secondaryButtonLabel="BILLING.CANCEL"
        (submit)="cancelReceipt()"
        (cancel)="showModal(cancelTemplate, 'md')"
      ></blg-action-area-dc>
    </div>
  </div>
</div>

<!-- Modals -->
<ng-template #receiptOverview>
  <div class="custom-modal">
    <blg-receipt-overview-modal-dc
      [receipt]="receipt"
      [establishment]="establishment"
      [isGccCountry]="isGccCountry"
      [currencyDetails]="currencyDetails"
      [gccCurrency]="gccCurrency"
      (closeModal)="hideModal()"
    >
    </blg-receipt-overview-modal-dc>
  </div>
</ng-template>

<ng-template #cancelTemplate>
  <gosi-confirm-modal-dc
    [message]="'BILLING.INFO-CANCEL'"
    (onConfirm)="navigateBack(isEditMode ? false : undefined)"
    (onCancel)="hideModal()"
  >
  </gosi-confirm-modal-dc>
</ng-template>
