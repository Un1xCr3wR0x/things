<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->
<!--This html is used for updating wage for multiple contributors-->

<div *ngIf="registrationNo">
  <div class="m-wage">
    <!-- Alert handling -->
    <gosi-alert-sc></gosi-alert-sc>
    <!--Content -->
    <cnt-contributor-list-action-dc
      [nationalityList]="nationalityList$ | async"
      [contributorWageDetailsResponse]="contributorWageDetailsResponse"
      [isRouteCustom]="false"
      [occupationList]="occupationList$ | async"
      [(isDescending)]="isDescending"
      [parentForm]="parentForm"
      [sortParameters]="sortParameters"
      (revertChanges)="revertChanges()"
      (stayOnPage)="confirmNoChanges()"
      (getContributorWageDetails)="fetchContWageDetails($event)"
      (clearFilterAlert)="clearFilterAlert()"
    ></cnt-contributor-list-action-dc>
    <!-- Table section starts-->
    <div class="row mb-4" *ngIf="contributorWageDetailsResponse.numberOfContributors > 0">
      <div class="col-md-12">
        <cnt-contributor-table-dc
          #contributorTableDcComponent
          [contributorWageDetailsResponse]="contributorWageDetailsResponse"
          [id]="paginationId"
          [occupationList]="occupationList$ | async"
          [parentForm]="parentForm"
          [legalEntity]="selectedLegalEntity"
          [currentPage]="pageDetails.currentPage"
          [pageSize]="10"
          [totalSize]="contributorWageDetailsResponse.numberOfContributors"
          [enableNavigation]="true"
          (navigate)="handleNavigation($event)"
          (jobClassListChange)="jobClassListChange($event)"
          (jobRankListChange)="jobRankListChange($event)"
          [isPPA]="ppaEstablishment"
          [lookUpDatas]="lookUpDatas"
        >
        </cnt-contributor-table-dc>
      </div>
    </div>

    <!-- Pagination starts -->
    <gosi-pagination-dc
      *ngIf="totalNumberOfActiveContributors > 0"
      [totalSize]="totalNumberOfActiveContributors"
      [pageDetails]="pageDetails"
      [paginationId]="paginationId"
      (pageChange)="selectPage($event)"
    ></gosi-pagination-dc>
    <div *ngIf="totalNumberOfActiveContributors > 0" class="d-flex justify-content-between">
      <div class="update-buttons">
        <!--Save and cancel button section-->
        <gosi-button-dc id="cancel" type="secondary" (submit)="showTemplate(cancelTemplate)">
          {{ 'CONTRIBUTOR.CANCEL' | translate }}</gosi-button-dc
        >
      </div>
      <div class="update-buttons">
        <gosi-button-dc
          id="verify"
          type="primary"
          (submit)="onSubmit()"
          [disabled]="isapiTriggered"
        >
          {{ 'CONTRIBUTOR.WAGE.SAVE' | translate }}</gosi-button-dc
        >
      </div>
    </div>
  </div>
</div>

<ng-template #saveTemplate>
  <cnt-confirm-modal-dc>
    <div card-header>
      {{ 'CONTRIBUTOR.WAGE.SAVE-CONFIRM' | translate }}
    </div>
    <div card-footer class="row justify-content-around">
      <div class="btn-section">
        <gosi-button-dc id="cancelBtn" type="secondary" (submit)="confirmNoChanges()">
          {{ 'CONTRIBUTOR.WAGE.CANCEL' | translate }} 
        </gosi-button-dc>
      </div>
      <div class="btn-section">
        <gosi-button-dc id="confirmBtn" type="primary" (submit)="updateContributorWageDetailsList()">
          {{ 'CONTRIBUTOR.CONFIRM' | translate }} 
        </gosi-button-dc>
      </div>
    </div>
  </cnt-confirm-modal-dc>
</ng-template>

<ng-template #noChangesTemplate>
  <cnt-confirm-modal-dc>
    <div card-header>{{ 'CONTRIBUTOR.WAGE.WAGE-NO-CHANGE' | translate }}</div>
    <div card-body></div>
    <div card-footer>
      <div class="row justify-content-center align-items-center">
        <div class="btn-section">
          <gosi-button-dc id="cancelBtn" type="secondary" (submit)="confirmNoChanges()">
            {{ 'CONTRIBUTOR.WAGE.OK' | translate }}
          </gosi-button-dc>
        </div>
      </div>
    </div>
  </cnt-confirm-modal-dc>
</ng-template>

<ng-template #navigateWithChangesTemplate>
  <cnt-confirm-modal-dc>
    <div card-header>
      {{ 'CONTRIBUTOR.WAGE.MULTI-WAGE-NAVIGATE-ERROR' | translate }}
    </div>
    <div card-footer class="row justify-content-around">
      <div class="btn-section">
        <gosi-button-dc id="cancelBtn" type="secondary" (submit)="revertChanges()">
          {{ 'CONTRIBUTOR.WAGE.DISCARD-CHANGES' | translate }}
        </gosi-button-dc>
      </div>
      <div class="btn-section">
        <gosi-button-dc id="confirmBtn" type="primary" (submit)="confirmNoChanges()">
          {{ 'CONTRIBUTOR.WAGE.STAY' | translate }}
        </gosi-button-dc>
      </div>
    </div>
  </cnt-confirm-modal-dc>
</ng-template>

<ng-template #navigateErrorTemplate>
  <cnt-confirm-modal-dc>
    <div card-header>
      {{ 'CONTRIBUTOR.WAGE.MULTI-WAGE-SAVE-ERROR-HEADER' | translate }}
    </div>
    <div card-body>
      {{ 'CONTRIBUTOR.WAGE.MULTI-WAGE-SAVE-ERROR-CONTENT' | translate }}
    </div>
    <div card-footer class="row">
      <div class="btn-section">
        <gosi-button-dc id="cancelBtn" type="primary" (submit)="confirmNoChanges()">
          {{ 'CONTRIBUTOR.WAGE.CANCEL' | translate }}
        </gosi-button-dc>
      </div>
      <div class="btn-section">
        <gosi-button-dc id="confirmBtn" type="secondary" (submit)="revertChanges()">
          {{ 'CONTRIBUTOR.WAGE.CONTINUE' | translate }}
        </gosi-button-dc>
      </div>
    </div>
  </cnt-confirm-modal-dc>
</ng-template>

<ng-template #navigateWithSummaryReport>
  <cnt-confirm-modal-dc>
    <div card-header class="error-content margin-bottom-20">
      <div class="text-danger" *ngIf="failedCount > 0">
        {{ 'CONTRIBUTOR.WAGE.UPDATE-WAGE-ERROR-INFO' | translate: { noOfFailures: failedCount } }}
      </div>
    </div>
    <div card-header class="error-content">
      <div>{{ 'CONTRIBUTOR.WAGE.OTHER-VALUES-UPDATED' | translate }}</div>
      <div>{{ 'CONTRIBUTOR.WAGE.FIX-OR-DISCARD' | translate }}</div>
    </div>
    <div card-footer class="row margin-bottom-25 justify-content-around">
      <div class="btn-section">
        <gosi-button-dc id="cancelBtn" type="outline-secondary" (submit)="revertChanges()">
          <div class="error-content">
            {{ 'CONTRIBUTOR.WAGE.DISCARD-CHANGES' | translate }}
          </div>
        </gosi-button-dc>
      </div>
      <div class="btn-section">
        <gosi-button-dc id="confirmBtn" type="primary" (submit)="confirmNoChanges()">
          <div class="error-content">
            {{ 'CONTRIBUTOR.WAGE.FIX-ERRORS' | translate }}
          </div>
        </gosi-button-dc>
      </div>
    </div>
  </cnt-confirm-modal-dc>
</ng-template>

<ng-template #cancelTemplate>
  <gosi-confirm-modal-dc message="CONTRIBUTOR.INFO-CANCEL" (onConfirm)="confirmCancel()" (onCancel)="decline()">
  </gosi-confirm-modal-dc>
</ng-template>

<!-- <ng-template #terminateTemplate>
  <gosi-modal-dc>
    <div modalContent>
      <div class="modal-head">{{ 'CONTRIBUTOR.TERMINATE-CONTRIBUTOR' | translate }}</div>
      <div class="message">
        {{ terminateMessage | translate: { name: personName, date: deathDate } }}
      </div>
    </div>

    <div modalAction>
      <div class="d-flex justify-content-center mt-3">
        <gosi-button-dc id="ok" type="primary" size="sm" (submit)="terminateContributor()">
          {{ 'CONTRIBUTOR.WAGE.OK' | translate }}</gosi-button-dc
        >
      </div>
    </div></gosi-modal-dc
  >
</ng-template> -->
