<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->
<div [formGroup]="establishmentDetailsForm" class="row">
  <div class="col-md-12">
    <gosi-card-dc type="secondary">
      <div class="row">
        <div class="col-lg-4 col-md-12" *ngIf="legalEntityList">
          <gosi-input-select-dc
            id="legalEntity"
            name="legalEntity"
            [label]="'ESTABLISHMENT.LEGAL-ENTITY' | translate"
            [control]="establishmentDetailsForm.get('legalEntity')"
            [lookup]="legalEntityList"
            (select)="selectLegalEntity()"
          >
          </gosi-input-select-dc>
        </div>
        <div class="col-lg-4 col-md-12" *ngIf="establishmentBranchTypeList">
          <gosi-input-radio-dc
            id="establishmentType"
            name="establishmentTypeList"
            label="ESTABLISHMENT.ESTABLISHMENT-TYPE"
            [control]="establishmentDetailsForm.get('establishmentType')"
            [list]="establishmentBranchTypeList"
            (select)="selectEstType($event)"
          >
          </gosi-input-radio-dc>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-8 col-md-12">
          <div class="row">
            <div class="col-lg-6 col-md-12" formGroupName="license">
              <gosi-input-text-dc
                id="licenseNumber"
                name="licenseNumber"
                [label]="'ESTABLISHMENT.LICENSE-NUMBER' | translate"
                [control]="establishmentDetailsForm.get('license').get('number')"
                [maxLength]="licenseNoMax"
              >
              </gosi-input-text-dc>
            </div>
            <div class="col-lg-6 col-md-12" formGroupName="license" *ngIf="licenseIssuingAuthorityList">
              <div>
                <gosi-input-select-dc
                  id="licenseIssuingAuthority"
                  name="licenseIssuingAuthority"
                  [label]="'ESTABLISHMENT.LICENSE-ISSUING-AUTHORITY' | translate"
                  [control]="establishmentDetailsForm.get('license').get('issuingAuthorityCode')"
                  [lookup]="licenseIssuingAuthorityList"
                >
                </gosi-input-select-dc>
              </div>
            </div>
            <div class="col-lg-6 col-md-12" formGroupName="license">
              <div formGroupName="issueDate">
                <gosi-input-date-dc
                  id="licenseIssueDate"
                  name="licenseIssueDate"
                  label="ESTABLISHMENT.LICENSE-ISSUE-DATE"
                  [control]="establishmentDetailsForm.get('license').get('issueDate').get('gregorian')"
                  [maxDate]="currentDate"
                ></gosi-input-date-dc>
              </div>
            </div>
            <div class="col-lg-6 col-md-12" formGroupName="license">
              <div formGroupName="expiryDate">
                <gosi-input-date-dc
                  id="licenseExpiryDate"
                  name="licenseExpiryDate"
                  label="ESTABLISHMENT.LICENSE-EXPIRY-DATE"
                  [control]="establishmentDetailsForm.get('license').get('expiryDate').get('gregorian')"
                  [minDate]="nextDay"
                  [gosiDateOverlap]="establishmentDetailsForm.get('license').get('issueDate').get('gregorian')"
                ></gosi-input-date-dc>
              </div>
            </div>
            <ng-template #cancelTemplate>
              <gosi-confirm-modal-dc
                [customFooter]="customOkButtonRef"
                [message]="'ESTABLISHMENT.LAW-TYPE-CHECK'"
                (onCancel)="decline()"
              >
              </gosi-confirm-modal-dc>
            </ng-template>
            <!--Law Type and dipartment number for PPA -->
            <ng-container *ngIf="establishment?.organizationCategory?.english === organisationTypeEnum.GOVERNMENT">
              <div class="col-lg-6 col-md-12">
                <gosi-input-select-dc
                  id="lawType"
                  name="lawType"
                  [label]="'ESTABLISHMENT.LAW-TYPE' | translate"
                  [control]="establishmentDetailsForm.get('lawType')"
                  [list]="lawTypeList"
                  (select)="selectLawType($event)"
                >
                </gosi-input-select-dc>
              </div>
              <div
                class="col-lg-6 col-md-12"
                *ngIf="
                  establishmentDetailsForm?.get('lawType.english')?.value === lawTypeEnum.CIVIL_PENSION_LAW &&
                  establishmentDetailsForm?.get('departmentNumber')
                "
              >
                <gosi-input-text-dc
                  id="departmentId"
                  name="departmentId"
                  [label]="'ESTABLISHMENT.DEPARTMENT-ID' | translate"
                  [control]="establishmentDetailsForm.get('departmentNumber')"
                  gosiSpecialCharacterMask
                  [onlyAlphaNumerics]="true"
                  [removeSpecialCharacters]="true"
                >
                </gosi-input-text-dc>
              </div>
            </ng-container>
          </div>
        </div>
        <div class="col-lg-4 col-md-12">
          <div class="row">
            <div class="col-lg-12">
              <gosi-input-number-dc
                id="recruitmentNumber"
                name="recruitmentNumber"
                [label]="'ESTABLISHMENT.RECRUITMENT-NO' | translate"
                [control]="establishmentDetailsForm.get('recruitmentNo')"
                [maxLength]="recruitmentNoMax"
              >
              </gosi-input-number-dc>
            </div>
          </div>
          <div class="row">
            <div
              class="col-lg-12"
              *ngIf="establishmentDetailsForm.get('establishmentType').get('english').value === estTypeBranch"
            >
              <gosi-input-number-dc
                id="mainEstablishmentRegistrationNo"
                name="mainEstablishmentRegistrationNo"
                [label]="'ESTABLISHMENT.MAIN-EST-REG-NO' | translate"
                [control]="establishmentDetailsForm.get('mainEstablishmentRegNo')"
              >
              </gosi-input-number-dc>
            </div>
          </div>
        </div>
      </div>
    </gosi-card-dc>
  </div>
</div>

<est-footer-buttons-dc
  [showCancel]="false"
  [showPrevious]="false"
  primaryLabel="ESTABLISHMENT.VERIFY"
  primaryId="verify"
  (submit)="verifyEstablishmentDetails()"
  [noMarginTop]="true"
></est-footer-buttons-dc>

<ng-template #template>
  <gosi-confirm-modal-dc
    [message]="'INFO-RESET'"
    (onConfirm)="confirm()"
    (onCancel)="decline()"
    iconName="warning"
  ></gosi-confirm-modal-dc>
</ng-template>

<ng-template #customOkButtonRef>
  <div class="btn-section">
    <gosi-button-dc id="cancelBtn" type="secondary" (submit)="decline()">{{ 'THEME.OK' | translate }} </gosi-button-dc>
  </div>
</ng-template>
