<!-- /**
 * Copyright GOSI. All Rights Reserved.
 * This software is the proprietary information of GOSI.
 * Use is subject to license terms.
 */ -->

<div class="billing-breadcrumb">
  <gosi-breadcrumb-dc> </gosi-breadcrumb-dc>
</div>
<!-------------------------------------------------------Header Section-------------------------------------------------------->
<div class="row header-section" id="vicAllocation">
  <div class="col-auto heading-main border-right">
    {{ 'BILLING.ALLOCATION' | translate }}
  </div>
  <div *ngIf="contributorName" class="col-8 heading-main mr-auto contributorName-margin" id="contributorName">
    <span *ngIf="(contributorName.contributorNameEng === undefined && lang === 'en') || lang === 'ar'"
      >{{ contributorName.contributorNameArb }}
    </span>
    <span *ngIf="contributorName.contributorNameEng !== null && lang === 'en'">
      {{ contributorName.contributorNameEng }}
    </span>
    <div class="d-md-none regno">
      <span> ({{ 'BILLING.REGISTRATION-NUMBER' | translate }} : {{ sinNo }}) </span>
    </div>
  </div>
  <div class="col-auto" id="contAllocationIcons" style="display: none">
    <img
      class="icon pr-3 img-sizes"
      id="pdfDownloadEstAllocationBills"
      alt="pdfDownloadAllocationBills"
      title="{{ 'BILLING.DOWNLOAD-BILL-AS-PDF' | translate }}"
      [src]="pdfImgSrc"
      (click)="downloadVicAllocationBill()"
      (mouseover)="pdfImgSrc = 'assets/images/downloadicons/pdf-on-green-bg-hover.svg'"
      (mouseout)="pdfImgSrc = 'assets/images/downloadicons/pdf-on-green-bg-normal.svg'"
    />

    <img
      class="icon pr-3 img-sizes"
      id="excelDownloadAllocationBills"
      alt="excelDownloadAllocationBills"
      title="{{ 'BILLING.DOWNLOAD-BILL-AS-EXCEL' | translate }}"
      [src]="excelImgSrc"
      (mouseover)="excelImgSrc = 'assets/images/downloadicons/xcel-on-green-bg-hover.svg'"
      (mouseout)="excelImgSrc = 'assets/images/downloadicons/xcel-on-green-bg-normal.svg'"
    />
    <img
      class="icon pe-3 img-sizes"
      id="printEstAllocationBills"
      alt="printAllocationBills"
      title="{{ 'BILLING.PRINT' | translate }}"
      [src]="printImgSrc"
      (click)="printVicAllocationBill()"
      (mouseover)="printImgSrc = 'assets/images/downloadicons/print-on-green-bg-hover.svg'"
      (mouseout)="printImgSrc = 'assets/images/downloadicons/print-on-green-bg-normal.svg'"
    />
  </div>
</div>
<div class="row regno d-none d-md-flex">
  <span class="col-lg-12"> ({{ 'BILLING.CONTRIBUTOR-NUMBER' | translate }} : {{ sinNo }}) </span>
</div>
<!------------------------------------Header Section Ends--------------------------------------------->
<!---------------------Content Head Section-------------------->
<div class="content">
  <div class="row content-head no-gutters">
    <div class="menu row no-gutters col-lg-auto">
      <div class="col-auto bill-headers d-flex align-items-center">
        <span class="back-arrow">
          <a (click)="navigateBack()">
            <fa-icon
              class="back-icon"
              [icon]="['far', lang === 'ar' ? 'arrow-alt-circle-right' : 'arrow-alt-circle-left']"
              size="2x"
            ></fa-icon>
          </a>
        </span>
        <span class="col-auto allocation-header" id="EstAllocationMonths">
          {{ 'BILLING.ALLOCATION-DUR-THE-MONTH' | translate }}
        </span>
      </div>
      <div class="col-lg-auto bill-month col-md-6 col-sm-12" *ngIf="maxDateCal !== null">
        <gosi-input-month-dc
          id="billMonths"
          [ignoreLabel]="true"
          [disabled]="false"
          [dateFormat]="dateFormat"
          [minDate]="minDateCal"
          [maxDate]="maxDateCal"
          [control]="allocationForm.get('month').get('gregorian')"
          (blur)="selectAllocationStartDate($event)"
        >
        </gosi-input-month-dc>
      </div>
    </div>
    <div class="col-lg-auto bill-month pl-lg-3 pr-lg-3 col-md-6 col-sm-12" *ngIf="maxDateHijiri">
      <gosi-input-hijiri-dc
        id="billMonths"
        [control]="allocationForm.get('month').get('hijiri')"
        [maxDate]="maxDateHijiri"
        [minDate]="minDatehijiri"
        [readOnly]="true"
        class="billMonth"
        [ignoreLabel]="true"
        [isMonthPicker]="true"
      >
      </gosi-input-hijiri-dc>
    </div>
    <ng-container>
      <div class="col-lg-3 sub-values p-2" id="billNumber" *ngIf="closeMonths">
        {{ 'BILLING.CLOSED-ON' | translate }}: {{ closeMonths | translate: closeDates }}
      </div>
    </ng-container>
  </div>
  <!----------------------------------Content Head Section Ends-------------------------------------------->
  <!----------------------------------Allocation Summary Table--------------------------------------------->
  <ng-container *ngIf="!isNoVicAllocation">
    <div class="summary-section">
      <div class="vicalloc-subheadings d-flex">
        {{ 'BILLING.ALLOCATION-SUMMARY' | translate }}
      </div>
      <blg-allocation-summary-dc
        [creditSummaryValue]="creditSummaryValue"
        [allocationCreditTotal]="allocationCreditTotal"
        [currentCurrency]="currentCurrency"
        [exchangeRate]="exchangeRate"
        [allocationDetails]="allocationDetails"
      ></blg-allocation-summary-dc>
    </div>
    <!----------------------------------Allocation Summary Table Ends------------------------------------------>
    <!----------------------------------Tabset------------------------------------------>
    <div class="add-margin-top" id="allocation-tabsets">
      <blg-allocation-tabset-dc
        [selectedTab]="selectedTab"
        [selectedDate]="dateSelected"
        [fromPage]="'contributorAllocation'"
        (tabSelected)="goToNewTab($event)"
        [billIssueDate]="billIssueDate"
        [tabList]="tabList"
      ></blg-allocation-tabset-dc>
    </div>
    <!----------------------------------Tabset Ends------------------------------------------>
    <div class="billtable">
      <!----------------------------------Credit--------------------------------------------->
      <div *ngIf="selectedTab === 'BILLING.CREDITS'">
        <blg-allocation-credit-summary-dc
          [allocationDetails]="allocationDetails"
          [exchangeRate]="exchangeRate"
          [currentCurrency]="currentCurrency"
          [fromPage]="'vic'"
        ></blg-allocation-credit-summary-dc>
      </div>
      <!----------------------------------Allocation of Credits----------------------------------->
      <div *ngIf="selectedTab === 'BILLING.ALLOCATION-OF-CREDITS'">
        <blg-allocation-credit-details-dc
          [allocationDetails]="allocationDetails"
          [currentCurrency]="currentCurrency"
          [exchangeRate]="exchangeRate"
          [fromPage]="'vicAllocationBill'"
        ></blg-allocation-credit-details-dc>
      </div>
      <!----------------------------------Summary of contribution and late fee---------------------------->
      <div *ngIf="selectedTab === 'BILLING.ALLOCATION-CONTRIBUTION-SUMMARY'">
        <blg-allocation-contribution-summary-dc
          [creditSummaryValue]="creditSummaryValue"
          [currentCurrency]="currentCurrency"
          [exchangeRate]="exchangeRate"
          [fromPage]="'vicAllocation'"
        ></blg-allocation-contribution-summary-dc>
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="isNoVicAllocation">
    <div class="mt-5 text-center full-width">
      <img src="assets/images/search-error.svg" alt="search-error" />
      <br />
      <p class="text-muted">{{ noBillMsg | bilingualText }}</p>
    </div>
  </ng-container>
</div>
