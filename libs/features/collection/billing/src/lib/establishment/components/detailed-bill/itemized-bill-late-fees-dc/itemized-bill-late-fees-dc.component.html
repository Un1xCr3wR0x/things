<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->

<div class="row late-fee-padding">
  <div class="col-auto mr-auto heading">
    {{ 'BILLING.LATE-PAYMENT-FEES' | translate | titlecase }} {{ 'BILLING.DETAILS' | translate | titlecase }}
  </div>
  <div class="d-flex latefees">
    <div class="late-fee-search">
      <gosi-search-dc [placeholder]="'BILLING.SEARCH' | translate"> </gosi-search-dc>
    </div>
    <div class="late-fee-filter">
      <gosi-filter-dc></gosi-filter-dc>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-lg-12">
    <div>
      <table class="table table-borderless table-responsive table-scroll">
        <thead class="thead-light">
          <tr>
            <th>{{ 'BILLING.LATEFEES-CONTRIBUTOR-DETAILS' | translate }}</th>
            <th>
              {{ 'BILLING.UNPAID-CONTRIBUTION' | translate }}
              <span class="late-fee">({{ 'BILLING.LATE-FEE-CURRENCY' | translate }})</span>
              <div>
                <fa-icon [icon]="['fas', 'info-circle']" [tooltip]="lateFeeunpaidMesg"></fa-icon>
              </div>
            </th>
            <th>
              {{ 'BILLING.LATE-FEES' | translate }}
              <span class="late-fee"> ({{ 'BILLING.LATE-FEE-CURRENCY' | translate }})</span>
              <div>
                <fa-icon [icon]="['fas', 'info-circle']" [tooltip]="lateFeeMesg"></fa-icon>
              </div>
            </th>

            <th>
              {{ 'BILLING.CUMULATIVE-CONTRIBUTION' | translate }}
              <span class="late-fee"> ({{ 'BILLING.LATE-FEE-CURRENCY' | translate }})</span>
              <div>
                <fa-icon [icon]="['fas', 'info-circle']" [tooltip]="lateFeecumulativeContMesg"></fa-icon>
              </div>
            </th>
            <th>
              {{ 'BILLING.CUMULATIVE-LATE-FEE' | translate
              }}<span class="late-fee"> ({{ 'BILLING.LATE-FEE-CURRENCY' | translate }})</span>
              <div>
                <fa-icon [icon]="['fas', 'info-circle']" [tooltip]="lateFeecumulativeLateMesg"></fa-icon>
              </div>
            </th>
            <th>
              {{ 'BILLING.EFFECTIVE-LATE-FEE' | translate
              }}<span class="late-fee"> ({{ 'BILLING.LATE-FEE-CURRENCY' | translate }})</span>
              <div>
                <fa-icon [icon]="['fas', 'info-circle']" [tooltip]="lateFeeeffectiveMesg"></fa-icon>
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <ng-container>
            <ng-container
              *ngFor="
                let latFeeItem of itemList
                  | paginate
                    : {
                        id: 'paginationId',
                        itemsPerPage: itemsPerPage,
                        currentPage: lateFeePage.currentPage,
                        totalItems: lateFeeDetails.noOfRecords
                      };
                let i = index
              "
            >
              <ng-container *ngIf="latFeeItem">
                <tr>
                  <td id="{{ 'nameDetails' }}">
                    <span *ngIf="(latFeeItem.person.name.english.name == undefined && lang === 'en') || lang === 'ar'"
                      >{{
                        latFeeItem.person.name.arabic.firstName +
                          ' ' +
                          latFeeItem.person.name.arabic.secondName +
                          ' ' +
                          latFeeItem.person.name.arabic.thirdName +
                          ' ' +
                          latFeeItem.person.name.arabic.familyName | bilingualText
                      }}
                    </span>
                    <span *ngIf="latFeeItem.person.name.english.name !== null && lang === 'en'">
                      {{ latFeeItem.person.name.english.name }}
                    </span>
                    <div *ngIf="latFeeItem.person.identity !== null">
                      <div *ngIf="latFeeItem.person.identity.idType === 'NIN'">
                        <span class="identity-heading"> ({{ 'BILLING.ID-NATIONAL' | translate }}: </span>
                        <span>
                          {{ latFeeItem.person.identity.newNin }}) ({{
                            latFeeItem.person.nationality | bilingualText
                          }})</span
                        >
                      </div>
                      <div *ngIf="latFeeItem.person.identity.idType === 'PASSPORT'">
                        <span class="identity-heading"> ({{ 'BILLING.PASSPORT' | translate }}: </span>
                        <span>
                          {{ latFeeItem.person.identity.passportNo }}) ({{
                            latFeeItem.person.nationality | bilingualText
                          }})
                        </span>
                      </div>
                      <div *ngIf="latFeeItem.person.identity.idType === 'IQAMA'">
                        <span class="identity-heading"> ({{ 'BILLING.IQAMA-NUMBER' | translate }}: </span>
                        <span>
                          {{ latFeeItem.person.identity.iqamaNo }}) ({{
                            latFeeItem.person.nationality | bilingualText
                          }})</span
                        >
                      </div>
                      <div *ngIf="latFeeItem.person.identity.idType === 'BORDERNO'">
                        <span class="identity-heading"> ({{ 'BILLING.BORDER-NUMBER' | translate }}: </span>
                        <span>
                          {{ latFeeItem.person.identity.id }}) ({{ latFeeItem.person.nationality | bilingualText }})
                        </span>
                      </div>
                    </div>
                  </td>

                  <td id="{{ 'lateFee' }}">
                    {{ latFeeItem.lateFee.unpaidContribution * exchangeRate | number: '1.2-2' }}
                  </td>
                  <td id="{{ 'lateFee' }}">
                    {{ latFeeItem.lateFee.lateFee * exchangeRate | number: '1.2-2' }}
                  </td>

                  <td id="{{ 'cumulativeContribution' }}">
                    {{ latFeeItem.lateFee.cumulativeContribution * exchangeRate | number: '1.2-2' }}
                  </td>
                  <td id="{{ 'cumulativeLateFees' }}">
                    {{ latFeeItem.lateFee.cumulativeLateFees * exchangeRate | number: '1.2-2' }}
                  </td>
                  <td id="{{ 'effectiveLateFees' }}">
                    {{ latFeeItem.lateFee.effectiveLateFees * exchangeRate | number: '1.2-2' }}
                  </td>
                </tr>
              </ng-container>
            </ng-container>
          </ng-container>
        </tbody>
      </table>
    </div>
  </div>
</div>
<ng-container>
  <div>
    <gosi-pagination-dc
      *ngIf="lateFeeDetails.noOfRecords > itemsPerPage"
      [totalSize]="lateFeeDetails.noOfRecords"
      [itemsPerPage]="itemsPerPage"
      [pageDetails]="lateFeePage"
      (pageChange)="selectedPage($event)"
      paginationId="paginationId"
    ></gosi-pagination-dc>
  </div>
</ng-container>
<ng-template #lateFeeunpaidMesg>
  <ng-container>
    <div>
      {{ 'BILLING.UNPAID-CONTRIBUTION-INFO' | translate }}
    </div>
  </ng-container>
</ng-template>
<ng-template #lateFeeeffectiveMesg>
  <ng-container>
    <div>
      {{ 'BILLING.EFFECTIVE-LATE-FEE-INFO' | translate }}
    </div>
  </ng-container>
</ng-template>
<ng-template #lateFeeMesg>
  <ng-container>
    <div>
      {{ 'BILLING.LATE-FEE-INFO' | translate }}
    </div>
  </ng-container>
</ng-template>
<ng-template #lateFeecumulativeContMesg>
  <ng-container>
    <div>
      {{ 'BILLING.CUMULATIVE-CONTRIBUTION-INFO' | translate }}
    </div>
  </ng-container>
</ng-template>
<ng-template #lateFeecumulativeLateMesg>
  <ng-container>
    <div>
      {{ 'BILLING.CUMULATIVE-LATE-FEE-INFO' | translate }}
    </div>
  </ng-container>
</ng-template>
