<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->
<router-outlet></router-outlet>
<div class="content">
  <div class="row">
    <div class="col-md-12">
      <est-heading-dc [canNavigate]="false" [showBackArrow]="false" [showSeparator]="false">
        <div class="margin-left">{{ 'ESTABLISHMENT.MEDICAL-INSURANCE-EXTENSION' | translate }}</div>
        <div id="action-item">
          <button class="overview-button" (click)="switchToFaq()">
            {{ 'ESTABLISHMENT.SERVICE-OVERVIEW' | translate }}
          </button>
        </div>
      </est-heading-dc>
      <gosi-alert-sc></gosi-alert-sc>
      <div class="table-padding">
        <div class="row">
          <div class="col-lg-12 table-scroll table-responsive full-width">
            <table class="table table-borderless">
              <thead class="thead-light shadow p-3 mb-5 bg-white rounded">
                <tr>
                  <th rowspan="3">
                    {{ 'ESTABLISHMENT.ESTABLISHMENT-NAME' | translate }}
                  </th>
                  <th rowspan="3">
                    {{ 'ESTABLISHMENT.REGISTRATION-NO' | translate }}
                  </th>
                  <th rowspan="3">
                    {{ 'ESTABLISHMENT.BRANCHES' | translate }}
                  </th>
                  <th rowspan="3">
                    {{ 'ESTABLISHMENT.REGISTRATION-STATUS' | translate }}
                  </th>
                  <th colspan="3">
                    {{ 'ESTABLISHMENT.INSURANCE-COMPANY' | translate }}
                  </th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let est of establishments">
                  <ng-container
                    *ngIf="!est.medicalInsurancePolicy.addPolicy"
                    [ngTemplateOutlet]="hasMedicalInsurance"
                    [ngTemplateOutletContext]="{ est: est }"
                  ></ng-container>
                  <ng-container
                    *ngIf="est.medicalInsurancePolicy.addPolicy"
                    [ngTemplateOutlet]="doesntHaveMedicalInsurance"
                    [ngTemplateOutletContext]="{ est: est }"
                  ></ng-container>
                </ng-container>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #hasMedicalInsurance let-est="est">
  <tr (click)="navigateToAddContributor(est.registrationNo)">
    <td id="{{ 'name' }}">
      <span>{{ est.name | bilingualText: true }}</span>
    </td>
    <td id="{{ 'regNo' }}">
      <span>{{ est.registrationNo }}</span>
    </td>
    <td id="{{ 'branchesNo' }}">
      <span>{{ est.noOfBranches }}</span>
    </td>
    <td id="{{ 'regStatus' }}">
      <span>{{ est.medicalInsurancePolicy.policyStatus | translate }}</span>
    </td>
    <td id="{{ 'insuranceCompany' }}">
      <span>{{ est.medicalInsurancePolicy.insuranceCompanyName | bilingualText: true }}</span>
    </td>
  </tr>
</ng-template>

<ng-template #doesntHaveMedicalInsurance let-est="est">
  <tr style="cursor: default">
    <td id="{{ 'name' }}">
      <span>{{ est.name | bilingualText: true }}</span>
    </td>
    <td id="{{ 'regNo' }}">
      <span>{{ est.registrationNo }}</span>
    </td>
    <td id="{{ 'branchesNo' }}">
      <span>{{ est.noOfBranches }}</span>
    </td>
    <td id="{{ 'regStatus' }}">
      <a class="enroll-link" [routerLink]="['./enroll']" (click)="alertService.clearAlerts()">{{
        'ESTABLISHMENT.REGISTER-AS-PARTNER' | translate
      }}</a>
    </td>
    <td id="{{ 'insuranceCompany' }}">
      <span>-</span>
    </td>
  </tr>
</ng-template>
