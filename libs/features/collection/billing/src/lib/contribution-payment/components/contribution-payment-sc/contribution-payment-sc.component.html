<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->

<div class="content">
  <div class="row" *ngIf="!paymentReceived">
    <div class="col-lg-12">
      <div class="main-heading">
        {{ headerValue | translate }}
      </div>
    </div>
  </div>
  <ng-container *ngIf="!isPrivateEst">
    <gosi-alert-sc></gosi-alert-sc>
    <div class="row" *ngIf="isCommentsPresent && !isAppPrivate">
      <div class="col-12">
        <gosi-comments-dc [comments]="comments"> </gosi-comments-dc>
      </div>
    </div>
    <ng-container *ngIf="!paymentReceived">
      <ng-container *ngIf="!mofFlag">
        <blg-establishment-info-dc [establishmentDetails]="establishmentDetails" [gccFlag]="gccFlag">
        </blg-establishment-info-dc>
      </ng-container>

      <gosi-progress-wizard-dc
        [wizardItems]="receiveContributionWizardItems"
        (clickWizard)="selectWizard($event)"
        #receiveContributionWizard
      >
      </gosi-progress-wizard-dc>

      <div class="row">
        <div class="col-lg-12">
          <div class="hide-tab">
            <tabset class="pills">
              <tab *ngIf="!isGovPayment" [active]="currentTab === 0">
                <div class="row">
                  <div class="col-lg-12">
                    <blg-payment-details-dc
                      [receiptMode]="receiptModesFilter$ | async"
                      [saudiBankList]="saudiBankListSorted$ | async"
                      [gccCountryList]="gccCountryListSorted$ | async"
                      [yesOrNoList]="yesOrNoList$ | async"
                      [establishmentTypeList]="establishmentTypeList$ | async"
                      [internationalCountryList]="internationalCountryListSorted$ | async"
                      [bankType]="bankType$ | async"
                      [establishmentDetails]="establishmentDetails"
                      [parentForm]="receiveContributionMainForm"
                      [branchLists]="branchDetails"
                      [outsideBranchLists]="outSideBranchDetails"
                      [receiptDetails]="receiptDetails"
                      [gccFlag]="gccFlag"
                      [mofFlag]="mofFlag"
                      [gccBankList]="gccBankListSorted$ | async"
                      [isBranchesClosed]="isBranchesClosed"
                      [currencyDetails]="currencyDetails"
                      [branchFilterDetails]="branchFilterDetails"
                      [establishmentLocationList]="establishmentLocationList$ | async"
                      [establishmentStatusList]="establishmentStatusList$ | async"
                      [fieldArray]="fieldArray"
                      [isPaymentSaved]="isPaymentSaved"
                      [noFilterResult]="noFilterResult"
                      [isAppPrivate]="isAppPrivate"
                      [initialExchangeRate]="initialExchangeRate"
                      (save)="savePaymentDetails()"
                      (cancel)="cancelForm()"
                      (gccBank)="getGCCBankList($event)"
                      (search)="searchBranches($event)"
                      (eventDate)="getEventDate($event)"
                      (exchangeRate)="getConversionRate($event)"
                      (outSideBranchSearch)="searchOutsideBranches($event)"
                      (validateOutsideBranch)="outSideBranchValidate($event)"
                      (branchDetailsFilter)="getbranchFilter($event)"
                      (penalityIndicator)="getPenlaityIndicator($event)"
                      (estType)="getEstType($event)"
                    ></blg-payment-details-dc>
                  </div>
                </div>
              </tab>
              <tab *ngIf="isGovPayment" [active]="currentTab === 0">
                <div class="row">
                  <div class="col-lg-12">
                    <blg-payment-details-dc
                      [receiptMode]="receiptModesFilter$ | async"
                      [saudiBankList]="saudiBankListSorted$ | async"
                      [gccCountryList]="gccCountryListSorted$ | async"
                      [yesOrNoList]="yesOrNoList$ | async"
                      [establishmentTypeList]="establishmentTypeList$ | async"
                      [internationalCountryList]="internationalCountryListSorted$ | async"
                      [bankType]="bankType$ | async"
                      [establishmentDetails]="establishmentDetails"
                      [parentForm]="receiveContributionMainForm"
                      [branchLists]="branchDetails"
                      [outsideBranchLists]="outSideBranchDetails"
                      [receiptDetails]="receiptDetails"
                      [gccFlag]="gccFlag"
                      [mofFlag]="mofFlag"
                      [gccBankList]="gccBankListSorted$ | async"
                      [isBranchesClosed]="isBranchesClosed"
                      [currencyDetails]="currencyDetails"
                      [branchFilterDetails]="branchFilterDetails"
                      [establishmentLocationList]="establishmentLocationList$ | async"
                      [establishmentStatusList]="establishmentStatusList$ | async"
                      [fieldArray]="fieldArray"
                      [isPaymentSaved]="isPaymentSaved"
                      [noFilterResult]="noFilterResult"
                      [isAppPrivate]="isAppPrivate"
                      [initialExchangeRate]="initialExchangeRate"
                      (currentReceipt)="getCurrentReceipt($event)"
                      (isCurrent)="getCurrentMode($event)"
                      (save)="savePaymentDetails()"
                      (cancel)="cancelForm()"
                      (gccBank)="getGCCBankList($event)"
                      (search)="searchBranches($event)"
                      (eventDate)="getEventDate($event)"
                      (exchangeRate)="getConversionRate($event)"
                      (outSideBranchSearch)="searchOutsideBranches($event)"
                      (validateOutsideBranch)="outSideBranchValidate($event)"
                      (branchDetailsFilter)="getbranchFilter($event)"
                      (penalityIndicator)="getPenlaityIndicator($event)"
                
                      (estType)="getEstType($event)"
                      [isGovPayment]="isGovPayment"
                      [paymentDetails]="govPaymentDetails"
                    ></blg-payment-details-dc>
                  </div>
                </div>
              </tab>
              <tab [active]="currentTab === 1">
                <blg-payment-file-upload-dc
                  [isScan]="isAppPrivate"
                  [documentList]="documentList"
                  [parentForm]="receiveContributionMainForm"
                  [receiptNumber]="receiptNumber"
                  (submit)="submitPaymentDetails()"
                  (refresh)="refreshDocument($event)"
                  (previous)="previousForm()"
                  (cancelBtn)="cancelForm()"
                  [isPaymentScanned]="isPaymentScanned"
                  [isChequeScanned]="isChequeScanned"
                ></blg-payment-file-upload-dc>
              </tab>
            </tabset>
          </div>
        </div>
      </div>
    </ng-container>

    <ng-container *ngIf="paymentReceived">
      <blg-payment-summary-dc
        [successMessage]="successMessage"
        [receiptPaymentSummaryDetails]="receiptPaymentSummaryDetails"
        [establishmentDetails]="establishmentDetails"
        [currencyDetails]="currencyDetails"
        [branchSummary]="branchSummary"
        [gccFlag]="gccFlag"
        [gccCurrency]="gccCurrency"
        (anotherTransaction)="getAnotherTransaction()"
        (print)="printTransaction()"
        [mofFlag]="mofFlag"
        [establishmentValues]="establishmentValues"
      ></blg-payment-summary-dc>
    </ng-container>
  </ng-container>
  <ng-container *ngIf="isPrivateEst">
    <div class="mt-5 text-center full-width">
      <img src="assets/images/search-error.svg" alt="search-error" />
      <br />
      <p class="text-muted">{{ 'BILLING.UNAUTHORIZED-ERROR' | translate }}</p>
    </div>
  </ng-container>
</div>
