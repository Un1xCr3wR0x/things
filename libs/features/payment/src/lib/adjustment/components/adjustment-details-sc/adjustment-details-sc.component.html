<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->
<gosi-breadcrumb-dc> </gosi-breadcrumb-dc>
<ng-container>
  <div class="content container-height">
    <pmt-payment-heading-dc
      (backEvent)="navigateToPrevious()"
      [shouldPrompt]="false"
    >
      {{ 'ADJUSTMENT.ADJUSTMENT-DETAILS' | translate }}
    </pmt-payment-heading-dc>
    <div class="row">
      <div class="col-sm-12">
        <gosi-alert-sc class="adjustment-alert"></gosi-alert-sc>
      </div>
    </div>
    <ng-container *ngIf="alertFlag && showWarning">
      <gosi-alert-dc [alert]="eligibilityWarningMsg"> </gosi-alert-dc>
    </ng-container>
    <div class="tab-container">
      <gosi-tabset-dc
        class="tabset-host"
        [groups]="adjustmentTabs"
        [selectedId]="selectedTab"
        (selectId)="selectTab($event)"
      ></gosi-tabset-dc>
    </div>
    <pmt-gosi-adjustment-list-dc
      [hidden]="adjustmentTabs[0]?.id !== selectedTab"
      class="mt-3"
      [netAdjustments]="netAdjustments"
      [adjustmentDetails]="adjustmentDetails"
      [adjustmentModificationEligibilty]="adjustmentModificationEligibilty"
      [debit]="debit"
      [direction]="direction"
      [payAdjustmentEligible]="payAdjustmentEligible"
      [benefitList]="benefitList | async"
      [adjustmentSort]="gosiAdjustmentSort | async"
      [activeAdjustments]="activeAdjustments"
      [activeAdjustmentsExist]="activeAdjustmentsExist"
      [enablePayOnline]="enablePayOnline"
      (filterTransactions)="filterTransactions($event)"
      (sortOrder)="sortOrder($event)"
      (navigateToBenefitDetails)="navigateToBenefitDetails($event)"
      (navigateToAdjustment)="navigateToAdjustment($event)"
      (navigateToCreate)="navigateToAddModify()"
      (navigateToPayAdjustment)="navigateToPayAdjustment()"
      (navigateToAddModify)="navigateToAddModify()"
      (navigateToPayOnline)="navigateToPayOnline()"
      (sortList)="sortList($event)"
      (showEligibilityModal)="showEligibilityWarning(eligibilityWarningTemplate)"
    >
    </pmt-gosi-adjustment-list-dc>
    <pmt-third-party-adjustment-list-dc
      [hidden]="adjustmentTabs[1]?.id !== selectedTab"
      [sortList]="gosiTpaAdjustmentSort | async"
      (navigateToAddModifyDet)="navigateToThirdpartyAddModifyDet($event)"
      [adjustmentDetails]="tpaAdjustmentDetails"
      [adjustmentFilters]="tpaAdjustmentFilters"
      [benefitTypeLovList]="tpaBenefitTypeLovList"
      [requestedByLovList]="tpaRequestedByLovList"
      [filterStatusList]="tpaAdjustmentStatus"
      [sortByinit]="tpaSortByinit"
      [searchParam]="tpaSearchValue"
      (filterTransactions)="getFilteredTpaAdjsutmentDetails($event, tpaSearchValue, tpaSortBy, tpaSortOrder)"
      (sortOrder)="getFilteredTpaAdjsutmentDetails(tpaAdjustmentFilters, tpaSearchValue, tpaSortBy, $event)"
      (sortBy)="getFilteredTpaAdjsutmentDetails(tpaAdjustmentFilters, tpaSearchValue, $event, tpaSortOrder)"
      (search)="getFilteredTpaAdjsutmentDetails(tpaAdjustmentFilters, $event, tpaSortBy, tpaSortOrder)"
      [popupFlag]="popupFlag"
      [elibilityResponse]="elibilityResponse"
      [eligibilityWarningMsg]="gosiWorkflowMsg"
      (navigateToTpaPage)="navigateToTpaView($event)"
      [tpaDebit]="debit"
      [netTpaAdjustments]="netTpaAdjustments"
      [monthlyAdjustmentAmount]="monthlyAdjustmentAmount"
    >
    </pmt-third-party-adjustment-list-dc>
  </div>
</ng-container>
<ng-template #eligibilityWarningTemplate>
  <gosi-modal-dc
    [modalHeader]="
      activeAdjustmentsExist ? ('ADJUSTMENT.ADD-MODIFY-CANCEL' | translate) : ('ADJUSTMENT.ADD-ADJUSTMENT' | translate)
    "
    [needCloseButton]="true"
    (closeModal)="modalRef.hide()"
  >
    <div modalContent>
      <div class="d-flex justify-content align-items-center flex-column">
        <img src="assets/icons/svg/warning_popup.svg" class="triangle-icon" alt="exclamation-triangle" />
        <gosi-alert-dc [alert]="gosiEligibilityWarningMsg"> </gosi-alert-dc>
      </div>
    </div>
    <div class="d-flex justify-content-center" modalAction>
      <gosi-button-dc type="secondary" id="close" (submit)="modalRef.hide()">
        {{ 'ADJUSTMENT.CLOSE' | translate }}</gosi-button-dc
      >
    </div>
  </gosi-modal-dc>
</ng-template>
