<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->
<gosi-breadcrumb-dc> </gosi-breadcrumb-dc>
<div class="content">
  <div>
    <div class="row heading-margin">
      <a (click)="navigateBack()" class="icon-seprator">
        <fa-icon
          class="back-icon"
          [icon]="['far', lang === 'ar' ? 'arrow-alt-circle-right' : 'arrow-alt-circle-left']"
          size="2x"
        ></fa-icon>
      </a>
      <span class="header"> {{ 'BILLING.INSTALLMENT' | translate }}</span>
    </div>
  </div>
  <gosi-alert-sc></gosi-alert-sc>
  <ng-container>
    <blg-installment-header-info-dc [establishmentDet]="establishmentDet"></blg-installment-header-info-dc>
    <gosi-progress-wizard-dc
      [wizardItems]="installmentWizardItems"
      (clickWizard)="selectWizard($event)"
      #installmentWizard
    >
    </gosi-progress-wizard-dc>
    <div class="hide-tab">
      <tabset class="pills">
        <tab [active]="currentTab === 0">
          <blg-installment-account-details-dc
            [installmentDetails]="installmentDetails"
          ></blg-installment-account-details-dc>
          <blg-installment-guarantee-details-dc
            [isAppPublic]="isAppPublic"
            [yesOrNoList]="yesOrNoList$ | async"
            [installmentGuaranteeType]="installmentGuaranteeType$ | async"
            [installmentAmount]="installmentAmount"
            [guaranteeTypeBanking]="guaranteeTypeBanking$ | async"
            [guaranteeTypePensionRegistered]="guaranteeTypePensionRegistered$ | async"
            [guaranteeTypePensionOutOfMarket]="guaranteeTypePensionOutOfMarket$ | async"
            [guaranteeTypeOthersRegistered]="guaranteeTypeOthersRegistered$ | async"
            [guaranteeTypeOthersOutOfMarket]="guaranteeTypeOthersOutOfMarket$ | async"
            [guaranteeTypePromissoryNote]="guaranteeTypePromissoryNote$ | async"
            [saudiBank]="saudiBank$ | async"
            [parentForm]="installmentMainForm"
            [inWorkflow]="inWorkflow"
            [showSearch]="showSearch"
            [isGuaranteeDisable]="isGuaranteeDisable"
            [isCollectionDeptMrg]="isCollectionDeptMrg"
            [installmentDetails]="installmentDetails"
            [installmentRequest]="installmentRequest"
            [establishmentOwnersWrap]="establishmentOwnersWrap"
            (downPaymentPercentage)="getDownPercentage($event)"
            (extensionValues)="getExtendedValues($event)"
            (downPaymentAmount)="setDownPaymentAmount($event)"
            (guaranteeStatus)="getguaranteeStatus($event)"
            (guaranteePercentage)="getguaranteePercentage($event)"
            (guaranteeType)="getguaranteeType($event)"
            (isDownPaymentEnabled)="getDownPayment($event)"
            (type)="getGuaranteeType()"
            (save)="saveAndNext()"
            (cancel)="navigateOnCancel()"
          ></blg-installment-guarantee-details-dc>
        </tab>
        <ng-container *ngIf="currentTab === 1">
          <tab [active]="currentTab === 1">
            <blg-installment-details-view-dc
              [isAppPublic]="isAppPublic"
              [amount]="amount"
              [modifiedInstallmentDetails]="modifiedInstallmentDetails"
              [isOwnerOnJob]="isOwnerOnJob"
              [installmentType]="guarantee"
              [installmentAmount]="installmentAmount"
              [installmentDetails]="installmentDetails"
              [downPayment]="downPayment"
              [installmentRequest]="installmentRequest"
              [inWorkflow]="inWorkflow"
              [isdownPayment]="isdownPayment"
              [isdownPaymentEnabled]="isdownPaymentEnabled"
              [isGuaranteeSelected]="isGuaranteeSelected"
              [isGuaranteeDisable]="isGuaranteeDisable"
              (cancel)="navigateOnCancel()"
              (previous)="previousForm()"
              (save)="save($event)"
              (currentInstallmentDetails)="setModifiedInstallmentDetails($event)"
              [isDisabled] = "isDisabled"
            ></blg-installment-details-view-dc>
          </tab>
        </ng-container>

        <tab [active]="currentTab === 2">
          <gosi-card-dc type="secondary">
            <blg-installment-file-upload-dc
              [documentList]="documents"
              [isScan]="!isAppPublic"
              [uuid]="uuid"
              [transactionId]="documentTransactionId"
              [businessKey]="regNumber"
              [referenceNo]="referenceNumber"
              (submit)="submitInstallmentDetails()"
              (previous)="previousForm()"
              [parentForm]="installmentMainForm"
              (cancelBtn)="navigateOnCancel()"
              (doc)="refreshDocuments($event)"
              [isDisabled] = "isDisabled"
            ></blg-installment-file-upload-dc>
          </gosi-card-dc>
        </tab>
      </tabset>
    </div>
  </ng-container>
</div>
