<!--
  ~ Copyright GOSI. All Rights Reserved.
  ~  This software is the proprietary information of GOSI.
  ~  Use is subject to license terms.
  -->

<div
  class="form-group fc-margin"
  [ngClass]="[ignoreLabel ? 'no-label' : '', size === 'sm' ? 'form-group-sm' : '']"
  [ngClass]="noMargin ? 'no-margin' : ''"
>
  <label *ngIf="!ignoreLabel">
    {{ label | translate }}
    <span class="optional-field" *ngIf="!isRequired() && !hideOptionalLabel">({{ 'THEME.OPTIONAL' | translate }})</span>
    <fa-icon
      class="info-icon"
      *ngIf="tooltipContent && !disabled"
      [icon]="['fas', 'info-circle']"
      [placement]="selectedLang === 'en' ? 'right' : 'left'"
      [tooltip]="toolTipTemplate"
    ></fa-icon>
  </label>
  <ng-template #toolTipTemplate>{{ tooltipContent | translate }}</ng-template>
  <div *ngIf="!items">
    Loading..
    <i class="fa fa-spinner fa-spin"></i>
  </div>
  <ng-container *ngIf="control && control.controls && !bindValueIsCode">
    <ng-select
      id="{{ id }}"
      [formControl]="control.controls.english"
      [config]
      class="select"
      [ngClass]="[validateField() ? 'is-invalid' : '', disabled ? 'disabled' : '']"
      *ngIf="items && selectedLang === 'en'"
      [items]="items"
      bindValue="value.english"
      bindLabel="value.english"
      [searchable]="searchable"
      (close)="close()"
      (clear)="clear()"
      [clearable]="!hideClear"
      placeholder="{{ hidePlaceholder === true ? null : ('THEME.SELECT' | translate) }} {{
        hidePlaceholder === true ? null : placeholder ? placeholder : (label | translate)
      }}"
      (blur)="onBlur($event)"
      (change)="change($event)"
      (ngModelChange)="onChange($event)"
      notFoundText="No items found"
      [inputAttrs]="inputAttrs"
      #selectInput
    >
    </ng-select>
    <ng-select
      id="{{ id }}"
      [formControl]="control.controls.english"
      [ngClass]="[validateField() ? 'is-invalid' : '', disabled ? 'disabled' : '']"
      *ngIf="items && selectedLang === 'ar'"
      [items]="items"
      class="select"
      bindValue="value.english"
      bindLabel="value.arabic"
      (close)="close()"
      (clear)="clear()"
      [searchable]="searchable"
      [clearable]="!hideClear"
      placeholder="{{ 'THEME.SELECT' | translate }} {{ placeholder ? placeholder : (label | translate) }}"
      (blur)="onBlur($event)"
      (change)="change($event)"
      notFoundText="لا يوجد سجل مطابق"
      [inputAttrs]="inputAttrs"
      #selectInput
    >
    </ng-select>
  </ng-container>
  <ng-container *ngIf="control && !control.controls && !bindValueIsCode">
    <ng-select
      id="{{ id }}"
      [formControl]="control"
      [ngClass]="[validateField() ? 'is-invalid' : '', disabled ? 'disabled' : '']"
      *ngIf="items"
      [items]="items"
      [searchable]="searchable"
      (close)="close()"
      (clear)="clear()"
      [clearable]="!hideClear"
      placeholder="{{ 'THEME.SELECT' | translate }} {{ placeholder ? placeholder : (label | translate) }}"
      (blur)="onBlur($event)"
      (change)="change($event)"
      notFoundText="{{ 'THEME.NO-ITEM-FOUND' | translate }}"
      [inputAttrs]="inputAttrs"
      #selectInput
    >
    </ng-select>
  </ng-container>
  <ng-container *ngIf="control && control.controls && bindValueIsCode">
    <ng-select
      id="{{ id }}"
      [formControl]="control.controls.english"
      [config]
      class="select"
      [ngClass]="[validateField() ? 'is-invalid' : '', disabled ? 'disabled' : '']"
      *ngIf="items && selectedLang === 'en'"
      [items]="items"
      bindValue="code"
      bindLabel="value.english"
      [searchable]="searchable"
      (close)="close()"
      (clear)="clear()"
      placeholder="{{ hidePlaceholder === true ? null : ('THEME.SELECT' | translate) }} {{
        hidePlaceholder === true ? null : placeholder ? placeholder : (label | translate)
      }}"
      (blur)="onBlur($event)"
      (change)="change($event)"
      notFoundText="No items found"
      #selectInput
    >
    </ng-select>
    <ng-select
      id="{{ id }}"
      [formControl]="control.controls.english"
      [ngClass]="[validateField() ? 'is-invalid' : '', disabled ? 'disabled' : '']"
      *ngIf="items && selectedLang === 'ar'"
      [items]="items"
      class="select"
      bindValue="code"
      bindLabel="value.arabic"
      [searchable]="searchable"
      (close)="close()"
      (clear)="clear()"
      placeholder="{{ 'THEME.SELECT' | translate }} {{ placeholder ? placeholder : (label | translate) }}"
      (blur)="onBlur($event)"
      (change)="change($event)"
      notFoundText="لا يوجد سجل مطابق"
      #selectInput
    >
    </ng-select>
  </ng-container>
  <small class="form-text text-muted" *ngIf="helpText">
    {{ helpText }}
  </small>
  <div class="invalid-feedback" id="{{ id }}-feedback" *ngIf="validationError">
    {{ validationError.error | translate: validationError }}
  </div>
</div>
