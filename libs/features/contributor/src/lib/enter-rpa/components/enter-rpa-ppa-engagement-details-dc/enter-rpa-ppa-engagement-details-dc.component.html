<gosi-card-dc type="secondary" [heading]="'CONTRIBUTOR.PPA-ENG-DETAILS' | translate">
  <div class="row mt-2">
    <div class="col-lg-4">
      <gosi-label-dc id="enterRpaStartDate"
        value="{{engagements?.ppaStartDate?.gregorian | date: 'dd/MM/yyyy' }}"
        [label]="'CONTRIBUTOR.PPA-START-DATE' | translate">
      </gosi-label-dc>
    </div>
    <div class="col-lg-4">
      <gosi-label-dc id="enterRpaEndDate"
        value="{{engagements?.ppaEndDate?.gregorian | date: 'dd/MM/yyyy' }}"
        [label]="'CONTRIBUTOR.PPA-END-DATE' | translate">
      </gosi-label-dc>
    </div>
    <div class="col-lg-4">
      <gosi-label-dc id="enterRpaContributionMonths" value="{{engagements?.totalPpaContributionMonth}}"
        [label]="'CONTRIBUTOR.CONTRIBUTION-MONTHS' | translate">
      </gosi-label-dc>
    </div>
    <div class="sub-heading col-12">
      <h5>{{'CONTRIBUTOR.LAST-WAGE-DETAILS'  | translate}}</h5>
    </div>
    <div class="col-lg-4">
      <gosi-label-dc 
        id="enterRpaJobClass" 
        value="{{engagements?.wageBreakPeriod?.jobClassName | bilingualText}}"
        [label]="'CONTRIBUTOR.JOB-CLASS' | translate">
      </gosi-label-dc>
    </div>
    <div class="col-lg-4">
      <gosi-label-dc id="enterRpaGrade"
        value="{{engagements?.wageBreakPeriod?.jobGradeCode}}"
        [label]="'CONTRIBUTOR.GRADE' | translate">
      </gosi-label-dc>
    </div>
    <div class="col-lg-4">
      <gosi-label-dc id="enterRpaRank" 
        value="{{engagements?.wageBreakPeriod?.jobRankCode}}"
        [label]="'CONTRIBUTOR.RANK' | translate">
      </gosi-label-dc>
    </div>
    <div  class="sub-heading col-12">
      <h5>{{'CONTRIBUTOR.WAGE-BREAKDOWN'  | translate}}</h5>
    </div>
    <div class="wage-table col-12">
      <div class="wage-table table-responsive gosi-scrollbar">
        <table class="table">
          <thead>
            <tr>
              <th>{{ 'CONTRIBUTOR.BASIC-SALARY' | translate }}</th>
              <th>{{ 'CONTRIBUTOR.HOUSING-BENEFITS' | translate }}</th>
              <th>{{ 'CONTRIBUTOR.WAGE.COMMISSIONS' | translate }}</th>
              <th>{{ 'CONTRIBUTOR.WAGE.OTHER-ALLOWANCE' | translate }}</th>
              <th>{{ 'CONTRIBUTOR.WAGE.TOTAL-WAGE' | translate }}</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <span *ngIf="engagements?.wageBreakPeriod?.wage?.basicWage as value; else nullValue"
                  >{{ value | number: '1.2-2' }}
                </span>
              </td>
              <td>
                <span *ngIf="engagements?.wageBreakPeriod?.wage?.housingBenefit as value; else nullValue">
                  {{ value | number: '1.2-2' }}
                </span>
              </td>
              <td>
                <span *ngIf="engagements?.wageBreakPeriod?.wage?.commission as value; else nullValue">
                  {{ value | number: '1.2-2' }}
                </span>
              </td>
              <td>
                <span *ngIf="engagements?.wageBreakPeriod?.wage?.otherAllowance as value; else nullValue">
                  {{ value | number: '1.2-2' }}
                </span>
              </td>
              <td>
                <span *ngIf="engagements?.wageBreakPeriod?.wage?.totalWage as value; else nullValue"
                  >{{ value | number: '1.2-2' }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <h4>{{'CONTRIBUTOR.CONTRIBUTION-HISTORY' | translate}}</h4>
    </div>
    <div class="row w-100">
      <div class="col-lg-12 col-md-12 col-sm-12 w-100 accordion-custom"
        *ngFor="let engagement of engagements.overallEngagements; let i = index">
        <gosi-accordion-dc *ngIf="engagement.ppaIndicator" [closeOthers]="true" [id]="'enterRpa-' + i" [isPrimaryColor]="true" class="modify-accordion">
          <div header>
            <div class="heading-wrapper">
              <div class="row align-items-center d-md-flex justify-content-between">
                <div class="accordion-heading-type col-lg-11 col-auto">
                  <div class="type-label">
                    <span>
                    {{
                    engagement?.establishmentName?.english === null
                    ? engagement.establishmentName?.arabic
                    : (engagement.establishmentName | bilingualText | titlecase)
                    }}
                  </span>
                  <span *ngIf="engagement?.hasOverlappingEngagement" class="overlap-position">
                    <ng-template #overlapMessage>
                      <span class="small-label"> {{ 'CONTRIBUTOR.OVERLAP-MSG' | translate }}</span>
                    </ng-template>
                    <img
                      src="assets/icons/overlap.svg"
                      placement="top"
                      class="image-ppa"
                      [tooltip]="overlapMessage"
                      alt="annuity"
                      (click)="imageClicked()"
                    />
                  </span>
                  </div>
                  <div class="type-value mt-2">
                    <div class="row">
                      <div class="col-12 date-value">
                        {{ engagement?.joiningDate | dateType }}
                        <fa-icon class="value-clrs" *ngIf="lang === 'en'" icon="arrow-right"></fa-icon>
                        <fa-icon class="value-clrs" *ngIf="lang === 'ar'" icon="arrow-left"></fa-icon>
                        <ng-container *ngIf="engagement?.leavingDate?.gregorian; else onwards">{{
                          engagement?.leavingDate | dateType
                          }}</ng-container>
                        <ng-template #onwards>
                          <span class="flag-endDate"> {{ 'CONTRIBUTOR.ONWARDS' | translate }}</span>
                        </ng-template>
                        <span class="ml-2">({{
                          'CONTRIBUTOR.NO-OF-MONTHS' | translate: { months: engagement.engagementDuration?.noOfMonths }
                          }}
                          , {{ 'CONTRIBUTOR.NO-OF-DAYS' | translate: { days: engagement.engagementDuration?.noOfDays }
                          }})
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-1 col-auto d-flex justify-content-end">
                  <span class="arrow-up">
                    <fa-icon icon="angle-up" size="lg"></fa-icon>
                  </span>
                  <span class="arrow-down">
                    <fa-icon icon="angle-down" size="lg"></fa-icon>
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div body>
            <div class="row mt-4">
              <div class="col-sm-12 col-md-4 col-lg-4">
                <gosi-label-dc id="registrationNo" label="CONTRIBUTOR.ESTABLISHMENT-REG-NO"
                  [value]="engagement.registrationNo"></gosi-label-dc>
              </div>
              <div class="col-sm-12 col-md-4 col-lg-4">
                <gosi-label-dc id="nameEnglish" label="CONTRIBUTOR.ESTABLISHMENT-NAME-EN"
                  [value]="engagement.establishmentName.english"></gosi-label-dc>
              </div>
              <div class="col-sm-12 col-md-4 col-lg-4">
                <gosi-label-dc id="nameArabic" label="CONTRIBUTOR.ESTABLISHMENT-NAME-AR"
                  [value]="engagement.establishmentName.arabic"></gosi-label-dc>
              </div>
              <div class="col-sm-12 col-md-4 col-lg-4">
                <gosi-label-dc id="nameArabic" label="CONTRIBUTOR.TERMINATION-REASON"
                  [value]="engagement.leavingReason | bilingualText"></gosi-label-dc>
              </div>
            </div>
            <div *ngIf="engagement.engagementPeriod?.length > 0" class="table-scroll table-responsive full-width">
              <table class="table table-borderless wage-table">
                <thead class="thead-light">
                  <tr>
                    <th>
                      {{ 'CONTRIBUTOR.PERIOD' | translate }}
                    </th>
                    <th>
                      {{ 'CONTRIBUTOR.TOTAL-WAGE' | translate }}
                    </th>
                    <th>{{ 'CONTRIBUTOR.WAGE.CONTRIBUTORY-WAGE' | translate}}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-bottom" *ngFor="let item of engagement.engagementPeriod">
                    <td class="d-flex">
                      <span *ngIf="item.startDate && item.startDate.gregorian">{{ item.startDate.gregorian | date: 'MMMM
                        yyyy' }}
                      </span>
                      <span class="pl-2 pr-2">
                        <fa-icon *ngIf="lang === 'en'" icon="arrow-right"></fa-icon>
                        <fa-icon *ngIf="lang === 'ar'" icon="arrow-left"></fa-icon>
                      </span>
                      <span *ngIf="item.endDate; else nullTemplate">
                        <span *ngIf="item.endDate.gregorian; else nullTemplate">
                          {{ item.endDate.gregorian | date: 'MMMM yyyy' }}
                        </span>
                      </span>
                      <ng-template #nullTemplate>{{ 'CONTRIBUTOR.ONWARDS' | translate }}</ng-template>
                      <span class="ml-2">({{
                        'CONTRIBUTOR.NO-OF-MONTHS' | translate: { months: item.periodDuration?.noOfMonths }
                        }}
                        , {{ 'CONTRIBUTOR.NO-OF-DAYS' | translate: { days: item.periodDuration?.noOfDays }
                        }})
                      </span>
                    </td>
                    <td>
                      {{ item.wage.totalWage | number: '1.0' }}
                    </td>
                    <td>
                      {{ item.wage.contributoryWage | number: '1.0' }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </gosi-accordion-dc>
      </div>
    </div>
  </div>
</gosi-card-dc>

<gosi-card-dc type="secondary" [heading]="'CONTRIBUTOR.GOSI-ENG-DETAILS' | translate">
  <div class="row mt-2">
    <div class="col-lg-6">
      <gosi-label-dc id="gosiStartDate" value="{{engagements?.gosiStartDate?.gregorian | date: 'dd/MM/yyyy'}}" [label]="'CONTRIBUTOR.START-DATES' | translate">
      </gosi-label-dc>
    </div>
    <div class="col-lg-6">
      <gosi-label-dc id="gosiContributionMonths" value="{{engagements?.totalGOSIContributionMonths}}" [label]="'CONTRIBUTOR.CONTRIBUTION-MONTHS' | translate">
      </gosi-label-dc>
    </div>
  </div>
</gosi-card-dc>

<gosi-card-dc type="secondary" [heading]="'CONTRIBUTOR.AGGREGATION-DETAILS' | translate">
  <div class="table-responsive months-table">
    <table class="table col-md-6 table-borderless">
      <tr>
        <th>{{'CONTRIBUTOR.PPA-CONTRIBUTIONS' | translate}}</th>
        <td>{{engagements.totalPpaContributionMonth}}</td>
      </tr>
      <tr>
        <th>{{'CONTRIBUTOR.GOSI-CONTRIBUTIONS' | translate}}</th>
        <td>{{engagements.totalGOSIContributionMonths}}</td>
      </tr>
      <tr>
        <th>{{'CONTRIBUTOR.TOTAL-GOSI-CONTRIBUTION' | translate}}</th>
        <td class="td-last">{{engagements.totalPpaContributionMonth + engagements.totalGOSIContributionMonths}}</td>
      </tr>
    </table>
  </div>
</gosi-card-dc>

<gosi-card-dc type="secondary">
  <div class="row m-0">
    <label for="engagementDeclaration">{{ 'CONTRIBUTOR.DECLARATION' | translate }}</label>
      <gosi-input-checkbox-dc
        id="enterRpaComments"
        name="enterRpaComments"
        [control]="appointmentForm.get('acknowledge')"
        [label]="'CONTRIBUTOR.RPA-DECLARATION' | translate"
      >
      </gosi-input-checkbox-dc>
    </div>
</gosi-card-dc>

<cnt-action-area-dc 
  [primaryButtonLabel]="'CONTRIBUTOR.SUBMIT'" 
  (submit)="saveEngagementDetails()"
  (cancel)="cancel()"></cnt-action-area-dc>


  <ng-template #nullValue>0.00</ng-template>
  <ng-template #notAvailable>
    <div class="null-value">{{ 'CONTRIBUTOR.WAGE.NOT-AVAILABLE' | translate }}</div>
  </ng-template>